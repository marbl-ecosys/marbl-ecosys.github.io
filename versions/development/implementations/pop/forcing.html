

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>POP Interacting with MARBL Requested Forcings &mdash; MARBL cesm2.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="MARBL cesm2.1 documentation" href="../../index.html"/>
        <link rel="up" title="MARBL examples in POP" href="index.html"/>
        <link rel="next" title="Processing MARBL Output" href="processing_MARBL_output.html"/>
        <link rel="prev" title="POP Interacting with MARBL Tracers" href="tracers.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> MARBL
          

          
          </a>

          
            
            
              <div class="version">
                
                  <div class="version-dropdown">
                    <select class="version-list" id="version-list">
                      <option value=''>cesm2.1</option>
                      
                        
                          <option value="../latest">latest</option>
                        
                      
                        
                      
                    </select>
                  </div>
                
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Marine Biogeochemistry Library</a></li>
</ul>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../usr-guide/index.html">MARBL user guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples of MARBL Implementation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../standalone/index.html">The MARBL Standalone Driver</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">MARBL examples in POP</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="tracers.html">POP Interacting with MARBL Tracers</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">POP Interacting with MARBL Requested Forcings</a></li>
<li class="toctree-l3"><a class="reference internal" href="processing_MARBL_output.html">Processing MARBL Output</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-guide/index.html">MARBL developer’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sci-guide/index.html">MARBL scientific documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-guide/repo-access/index.html">Rules of engagement</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MARBL</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Examples of MARBL Implementation</a> &raquo;</li>
        
          <li><a href="index.html">MARBL examples in POP</a> &raquo;</li>
        
      <li>POP Interacting with MARBL Requested Forcings</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/implementations/pop/forcing.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pop-interacting-with-marbl-requested-forcings">
<span id="pop-forcing"></span><h1>POP Interacting with MARBL Requested Forcings<a class="headerlink" href="#pop-interacting-with-marbl-requested-forcings" title="Permalink to this headline">¶</a></h1>
<p>POP mirrors the MARBL datatypes for forcing fields and the associated metadata, but expands the metadata class to also manage the source of the data (read from a file, provided by POP, provided by the flux coupler, etc).
In the code below, <code class="docutils literal notranslate"><span class="pre">marbl_req_surface_flux_forcings(:)</span></code> is the MARBL data provided through the interface, and <code class="docutils literal notranslate"><span class="pre">surface_flux_forcings(:)</span></code> is the copy into the POP datatype.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">do </span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">surface_flux_forcings</span><span class="p">)</span>
<span class="w">  </span><span class="n">marbl_varname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">marbl_req_surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">metadata</span><span class="p">%</span><span class="n">varname</span>
<span class="w">  </span><span class="n">units</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="n">marbl_req_surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">metadata</span><span class="p">%</span><span class="n">field_units</span>
<span class="w">  </span><span class="k">select case</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">marbl_req_surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">metadata</span><span class="p">%</span><span class="n">varname</span><span class="p">))</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;d13c&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="n">d13c_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">      </span><span class="k">call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;internal&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">           </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                           </span><span class="p">&amp;</span>
<span class="w">           </span><span class="n">driver_varname</span><span class="o">=</span><span class="s1">&#39;d13C&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;d14c&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="n">d14c_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">      </span><span class="k">call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;internal&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">           </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                           </span><span class="p">&amp;</span>
<span class="w">           </span><span class="n">driver_varname</span><span class="o">=</span><span class="s1">&#39;D14C&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;u10_sqr&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="n">u10sqr_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">      </span><span class="k">call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;internal&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">           </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                           </span><span class="p">&amp;</span>
<span class="w">           </span><span class="n">driver_varname</span><span class="o">=</span><span class="s1">&#39;U10_SQR&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;sst&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="n">sst_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">      </span><span class="k">call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;internal&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">           </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                           </span><span class="p">&amp;</span>
<span class="w">           </span><span class="n">driver_varname</span><span class="o">=</span><span class="s1">&#39;SST&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;sss&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="n">sss_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">      </span><span class="k">call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;internal&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">           </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                           </span><span class="p">&amp;</span>
<span class="w">           </span><span class="n">driver_varname</span><span class="o">=</span><span class="s1">&#39;SSS&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;xco2&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">atm_co2_opt</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;const&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;const&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">field_constant</span><span class="o">=</span><span class="n">atm_co2_const</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">atm_co2_opt</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;drv_prog&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;named_field&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                              </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">named_field</span><span class="o">=</span><span class="s1">&#39;ATM_CO2_PROG&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">atm_co2_opt</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;drv_diag&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;named_field&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                              </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">named_field</span><span class="o">=</span><span class="s1">&#39;ATM_CO2_DIAG&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">atm_co2_opt</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;box_atm_co2&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">box_atm_co2_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="k">call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;internal&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                           </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">driver_varname</span><span class="o">=</span><span class="s1">&#39;box_atm_co2&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">else</span>
<span class="k">        write</span><span class="p">(</span><span class="n">err_msg</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(A,1X,A)&quot;</span><span class="p">)</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">atm_co2_opt</span><span class="p">),</span><span class="w">                     </span><span class="p">&amp;</span>
<span class="w">             </span><span class="s1">&#39;is not a valid option for atm_co2_opt&#39;</span>
<span class="w">        </span><span class="k">call </span><span class="n">document</span><span class="p">(</span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="n">err_msg</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">exit_POP</span><span class="p">(</span><span class="n">sigAbort</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Stopping in &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">subname</span><span class="p">)</span>
<span class="w">      </span><span class="k">end if</span>

<span class="k">    case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;xco2_alt_co2&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">atm_alt_co2_opt</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;const&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;const&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">field_constant</span><span class="o">=</span><span class="n">atm_alt_co2_const</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">atm_alt_co2_opt</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;box_atm_co2&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">atm_co2_opt</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;box_atm_co2&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          </span><span class="n">box_atm_co2_dup_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="k">else</span>
<span class="k">          </span><span class="n">box_atm_co2_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="k">end if</span>
<span class="k">        call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;internal&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                           </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">driver_varname</span><span class="o">=</span><span class="s1">&#39;box_atm_co2&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">else</span>
<span class="k">        write</span><span class="p">(</span><span class="n">err_msg</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(A,1X,A)&quot;</span><span class="p">)</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">atm_alt_co2_opt</span><span class="p">),</span><span class="w">                 </span><span class="p">&amp;</span>
<span class="w">             </span><span class="s1">&#39;is not a valid option for atm_alt_co2_opt&#39;</span>
<span class="w">        </span><span class="k">call </span><span class="n">document</span><span class="p">(</span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="n">err_msg</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">exit_POP</span><span class="p">(</span><span class="n">sigAbort</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Stopping in &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">subname</span><span class="p">)</span>
<span class="w">      </span><span class="k">end if</span>

<span class="k">    case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Ice Fraction&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="n">ifrac_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">gas_flux_forcing_opt</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;drv&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;internal&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                           </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">driver_varname</span><span class="o">=</span><span class="s1">&#39;ICE Fraction&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">gas_flux_forcing_opt</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;file&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">file_details</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">fice_file_loc</span>
<span class="w">        </span><span class="k">call </span><span class="n">init_monthly_surface_flux_forcing_metadata</span><span class="p">(</span><span class="n">file_details</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="w">                    </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;POP monthly calendar&#39;</span><span class="p">,</span><span class="w">                                 </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                      </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">forcing_calendar_name</span><span class="o">=</span><span class="n">file_details</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">else</span>
<span class="k">        write</span><span class="p">(</span><span class="n">err_msg</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(A,1X,A)&quot;</span><span class="p">)</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">gas_flux_forcing_opt</span><span class="p">),</span><span class="w">            </span><span class="p">&amp;</span>
<span class="w">             </span><span class="s1">&#39;is not a valid option for gas_flux_forcing_opt&#39;</span>
<span class="w">        </span><span class="k">call </span><span class="n">document</span><span class="p">(</span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="n">err_msg</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">exit_POP</span><span class="p">(</span><span class="n">sigAbort</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Stopping in &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">subname</span><span class="p">)</span>
<span class="w">      </span><span class="k">end if</span>

<span class="k">    case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Atmospheric Pressure&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="n">ap_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">gas_flux_forcing_opt</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;drv&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;internal&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                           </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">driver_varname</span><span class="o">=</span><span class="s1">&#39;AP_FILE_INPUT&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">gas_flux_forcing_opt</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;file&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">file_details</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">ap_file_loc</span>
<span class="w">        </span><span class="k">call </span><span class="n">init_monthly_surface_flux_forcing_metadata</span><span class="p">(</span><span class="n">file_details</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="w">                    </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;POP monthly calendar&#39;</span><span class="p">,</span><span class="w">                                 </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                      </span><span class="p">&amp;</span>
<span class="w">                             </span><span class="n">forcing_calendar_name</span><span class="o">=</span><span class="n">file_details</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">else</span>
<span class="k">        write</span><span class="p">(</span><span class="n">err_msg</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(A,1X,A)&quot;</span><span class="p">)</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">gas_flux_forcing_opt</span><span class="p">),</span><span class="w">            </span><span class="p">&amp;</span>
<span class="w">             </span><span class="s1">&#39;is not a valid option for gas_flux_forcing_opt&#39;</span>
<span class="w">        </span><span class="k">call </span><span class="n">document</span><span class="p">(</span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="n">err_msg</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">exit_POP</span><span class="p">(</span><span class="n">sigAbort</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Stopping in &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">subname</span><span class="p">)</span>
<span class="w">      </span><span class="k">end if</span>

<span class="k">    case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Dust Flux&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="n">dust_dep_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">dust_flux_source</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;driver&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;internal&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                           </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">driver_varname</span><span class="o">=</span><span class="s1">&#39;DUST_FLUX&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">dust_flux_source</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;monthly-calendar&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">file_details</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">dust_flux_file_loc</span>
<span class="w">        </span><span class="k">call </span><span class="n">init_monthly_surface_flux_forcing_metadata</span><span class="p">(</span><span class="n">file_details</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="w">                    </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;POP monthly calendar&#39;</span><span class="p">,</span><span class="w">                                 </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                      </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">forcing_calendar_name</span><span class="o">=</span><span class="n">file_details</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">else</span>
<span class="k">        write</span><span class="p">(</span><span class="n">err_msg</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(A,1X,A)&quot;</span><span class="p">)</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">dust_flux_source</span><span class="p">),</span><span class="w">                </span><span class="p">&amp;</span>
<span class="w">             </span><span class="s1">&#39;is not a valid option for dust_flux_source&#39;</span>
<span class="w">        </span><span class="k">call </span><span class="n">document</span><span class="p">(</span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="n">err_msg</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">exit_POP</span><span class="p">(</span><span class="n">sigAbort</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Stopping in &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">subname</span><span class="p">)</span>
<span class="w">      </span><span class="k">end if</span>

<span class="k">    case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Iron Flux&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">iron_flux_source</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;driver-derived&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">bc_dep_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="k">call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;internal&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                           </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">driver_varname</span><span class="o">=</span><span class="s1">&#39;BLACK_CARBON_FLUX&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">iron_flux_source</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;monthly-calendar&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">Fe_dep_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="n">file_details</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">iron_flux_file_loc</span>
<span class="w">        </span><span class="k">call </span><span class="n">init_monthly_surface_flux_forcing_metadata</span><span class="p">(</span><span class="n">file_details</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="w">                    </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;POP monthly calendar&#39;</span><span class="p">,</span><span class="w">                                 </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                      </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">forcing_calendar_name</span><span class="o">=</span><span class="n">file_details</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">else</span>
<span class="k">        write</span><span class="p">(</span><span class="n">err_msg</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(A,1X,A)&quot;</span><span class="p">)</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">iron_flux_source</span><span class="p">),</span><span class="w">                </span><span class="p">&amp;</span>
<span class="w">             </span><span class="s1">&#39;is not a valid option for iron_flux_source&#39;</span>
<span class="w">        </span><span class="k">call </span><span class="n">document</span><span class="p">(</span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="n">err_msg</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">exit_POP</span><span class="p">(</span><span class="n">sigAbort</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Stopping in &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">subname</span><span class="p">)</span>
<span class="w">      </span><span class="k">end if</span>

<span class="k">    case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;NOx Flux&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">ndep_data_type</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;shr_stream&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;shr_stream&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">strdata_inputlist_ptr</span><span class="o">=</span><span class="n">surface_strdata_inputlist_ptr</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                             </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">unit_conv_factor</span><span class="o">=</span><span class="n">ndep_shr_stream_scale_factor</span><span class="p">,</span><span class="w">                              </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">file_varname</span><span class="o">=</span><span class="s1">&#39;NOy_deposition&#39;</span><span class="p">,</span><span class="w">                                              </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">year_first</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ndep_shr_stream_year_first</span><span class="p">,</span><span class="w">                                    </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">year_last</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ndep_shr_stream_year_last</span><span class="p">,</span><span class="w">                                      </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">year_align</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ndep_shr_stream_year_align</span><span class="p">,</span><span class="w">                                    </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ndep_shr_stream_file</span><span class="p">,</span><span class="w">                                            </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">rank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">ndep_data_type</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;monthly-calendar&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">file_details</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">nox_flux_monthly_file_loc</span>
<span class="w">        </span><span class="k">call </span><span class="n">init_monthly_surface_flux_forcing_metadata</span><span class="p">(</span><span class="n">file_details</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="w">                    </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;POP monthly calendar&#39;</span><span class="p">,</span><span class="w">                                 </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                      </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">forcing_calendar_name</span><span class="o">=</span><span class="n">file_details</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">ndep_data_type</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;driver&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;named_field&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                              </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">named_field</span><span class="o">=</span><span class="s1">&#39;ATM_NOy&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">else</span>
<span class="k">        write</span><span class="p">(</span><span class="n">err_msg</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(A,1X,A)&quot;</span><span class="p">)</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">ndep_data_type</span><span class="p">),</span><span class="w">                  </span><span class="p">&amp;</span>
<span class="w">             </span><span class="s1">&#39;is not a valid option for ndep_data_type&#39;</span>
<span class="w">        </span><span class="k">call </span><span class="n">document</span><span class="p">(</span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="n">err_msg</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">exit_POP</span><span class="p">(</span><span class="n">sigAbort</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Stopping in &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">subname</span><span class="p">)</span>
<span class="w">      </span><span class="k">end if</span>

<span class="k">    case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;NHy Flux&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">ndep_data_type</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;shr_stream&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;shr_stream&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">strdata_inputlist_ptr</span><span class="o">=</span><span class="n">surface_strdata_inputlist_ptr</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                             </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">unit_conv_factor</span><span class="o">=</span><span class="n">ndep_shr_stream_scale_factor</span><span class="p">,</span><span class="w">                              </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">file_varname</span><span class="o">=</span><span class="s1">&#39;NHx_deposition&#39;</span><span class="p">,</span><span class="w">                                              </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">year_first</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ndep_shr_stream_year_first</span><span class="p">,</span><span class="w">                                    </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">year_last</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ndep_shr_stream_year_last</span><span class="p">,</span><span class="w">                                      </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">year_align</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ndep_shr_stream_year_align</span><span class="p">,</span><span class="w">                                    </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ndep_shr_stream_file</span><span class="p">,</span><span class="w">                                            </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">rank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">ndep_data_type</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;monthly-calendar&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">file_details</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">nhy_flux_monthly_file_loc</span>
<span class="w">        </span><span class="k">call </span><span class="n">init_monthly_surface_flux_forcing_metadata</span><span class="p">(</span><span class="n">file_details</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="w">                    </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;POP monthly calendar&#39;</span><span class="p">,</span><span class="w">                                 </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                      </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">forcing_calendar_name</span><span class="o">=</span><span class="n">file_details</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">ndep_data_type</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;driver&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;named_field&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                              </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">named_field</span><span class="o">=</span><span class="s1">&#39;ATM_NHx&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">else</span>
<span class="k">        write</span><span class="p">(</span><span class="n">err_msg</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(A,1X,A)&quot;</span><span class="p">)</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">ndep_data_type</span><span class="p">),</span><span class="w">                  </span><span class="p">&amp;</span>
<span class="w">             </span><span class="s1">&#39;is not a valid option for ndep_data_type&#39;</span>
<span class="w">        </span><span class="k">call </span><span class="n">document</span><span class="p">(</span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="n">err_msg</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">exit_POP</span><span class="p">(</span><span class="n">sigAbort</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Stopping in &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">subname</span><span class="p">)</span>
<span class="w">      </span><span class="k">end if</span>

<span class="k">    case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;external C Flux&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="n">ext_C_flux_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">      </span><span class="k">call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;internal&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">           </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                           </span><span class="p">&amp;</span>
<span class="w">           </span><span class="n">driver_varname</span><span class="o">=</span><span class="s1">&#39;ext_C_flux&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;external P Flux&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="n">ext_P_flux_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">      </span><span class="k">call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;internal&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">           </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                           </span><span class="p">&amp;</span>
<span class="w">           </span><span class="n">driver_varname</span><span class="o">=</span><span class="s1">&#39;ext_P_flux&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;external Si Flux&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="n">ext_Si_flux_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">      </span><span class="k">call </span><span class="n">surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;internal&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">           </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">                           </span><span class="p">&amp;</span>
<span class="w">           </span><span class="n">driver_varname</span><span class="o">=</span><span class="s1">&#39;ext_Si_flux&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="w">    </span><span class="k">case </span><span class="n">DEFAULT</span>
<span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="n">err_msg</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(A,1X,A)&quot;</span><span class="p">)</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">marbl_req_surface_flux_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">metadata</span><span class="p">%</span><span class="n">varname</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                     </span><span class="s1">&#39;is not a valid surface flux forcing field name.&#39;</span>
<span class="w">      </span><span class="k">call </span><span class="n">document</span><span class="p">(</span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="n">err_msg</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">exit_POP</span><span class="p">(</span><span class="n">sigAbort</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Stopping in &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">subname</span><span class="p">)</span>
<span class="w">  </span><span class="k">end select</span>
<span class="k">end do</span>
</pre></div>
</div>
<p>Note that POP uses <code class="docutils literal notranslate"><span class="pre">field_source</span></code> to denote where it will be getting the forcing field.
Not shown in this example is where POP actually populates the data.
The code for interior forcing fields looks similar, although there are far fewer fields to handle and that results in a shorter code snippet.
Again, <code class="docutils literal notranslate"><span class="pre">marbl_req_interior_tendency_forcings</span></code> is provided through the MARBL interface and <code class="docutils literal notranslate"><span class="pre">interior_tendency_forcings</span></code> is a POP construct.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">do </span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">interior_tendency_forcings</span><span class="p">)</span>
<span class="w">  </span><span class="n">marbl_varname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">marbl_req_interior_tendency_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">metadata</span><span class="p">%</span><span class="n">varname</span>
<span class="w">  </span><span class="n">units</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">marbl_req_interior_tendency_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">metadata</span><span class="p">%</span><span class="n">field_units</span>

<span class="w">  </span><span class="n">var_processed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">  </span><span class="c">! Check to see if this forcing field is tracer restoring</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">index</span><span class="p">(</span><span class="n">marbl_varname</span><span class="p">,</span><span class="s1">&#39;Restoring Field&#39;</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">    </span><span class="n">tracer_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">marbl_varname</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">scan</span><span class="p">(</span><span class="n">marbl_varname</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">)))</span>
<span class="w">    </span><span class="k">do </span><span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">marbl_tracer_cnt</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">tracer_name</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="nb">trim</span><span class="p">(</span><span class="n">restorable_tracer_names</span><span class="p">(</span><span class="n">m</span><span class="p">)))</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="c">! Check to make sure restore_data_filenames and</span>
<span class="w">        </span><span class="c">! restore_data_file_varnames have both been provided by namelist</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">len_trim</span><span class="p">(</span><span class="n">restore_data_filenames</span><span class="p">(</span><span class="n">m</span><span class="p">)).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          write</span><span class="p">(</span><span class="n">err_msg</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(3A)&quot;</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;No file provided to read restoring &quot;</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span>
<span class="w">                                 </span><span class="s2">&quot;field for &quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">tracer_name</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">document</span><span class="p">(</span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="n">err_msg</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">exit_POP</span><span class="p">(</span><span class="n">sigAbort</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Stopping in &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">subname</span><span class="p">)</span>
<span class="w">        </span><span class="k">end if</span>
<span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="nb">len_trim</span><span class="p">(</span><span class="n">restore_data_file_varnames</span><span class="p">(</span><span class="n">m</span><span class="p">)).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          write</span><span class="p">(</span><span class="n">err_msg</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(3A)&quot;</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;No variable name provided to read &quot;</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span>
<span class="w">                                 </span><span class="s2">&quot;restoring field for &quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">tracer_name</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">document</span><span class="p">(</span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="n">err_msg</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">exit_POP</span><span class="p">(</span><span class="n">sigAbort</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Stopping in &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">subname</span><span class="p">)</span>
<span class="w">        </span><span class="k">end if</span>
<span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">my_task</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">master_task</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          write</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(6A)&quot;</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;Will restore &quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">tracer_name</span><span class="p">),</span><span class="w">       </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="s2">&quot; with &quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">restore_data_file_varnames</span><span class="p">(</span><span class="n">m</span><span class="p">)),</span><span class="w">    </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="s2">&quot; from &quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">restore_data_filenames</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<span class="w">        </span><span class="k">end if</span>
<span class="k">        call </span><span class="n">interior_tendency_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="w">                </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;shr_stream&#39;</span><span class="p">,</span><span class="w">                             </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">strdata_inputlist_ptr</span><span class="o">=</span><span class="n">interior_strdata_inputlist_ptr</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">filename</span><span class="o">=</span><span class="n">restore_data_filenames</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="w">                    </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">file_varname</span><span class="o">=</span><span class="n">restore_data_file_varnames</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="w">            </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">year_first</span><span class="o">=</span><span class="n">restore_year_first</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="w">                      </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">year_last</span><span class="o">=</span><span class="n">restore_year_last</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="w">                        </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">year_align</span><span class="o">=</span><span class="n">restore_year_align</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="w">                      </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">unit_conv_factor</span><span class="o">=</span><span class="n">restore_scale_factor</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="w">              </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">rank</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">dim3_len</span><span class="o">=</span><span class="n">km</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">        </span><span class="n">var_processed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">        </span><span class="k">exit</span>
<span class="k">      end if</span>
<span class="k">    end do</span>
<span class="k">  end if</span>

<span class="w">  </span><span class="c">! Check to see if this forcing field is a restoring time scale</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">index</span><span class="p">(</span><span class="n">marbl_varname</span><span class="p">,</span><span class="s1">&#39;Restoring Inverse Timescale&#39;</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">    select case</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">restore_inv_tau_opt</span><span class="p">))</span>
<span class="w">      </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;const&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">interior_tendency_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="w">                </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;const&#39;</span><span class="p">,</span><span class="w">                                  </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">field_constant</span><span class="o">=</span><span class="n">restore_inv_tau_const</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">rank</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">dim3_len</span><span class="o">=</span><span class="n">km</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;file_time_invariant&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">interior_tendency_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="w">                </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;file_time_invariant&#39;</span><span class="p">,</span><span class="w">                    </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">filename</span><span class="o">=</span><span class="n">restore_inv_tau_input</span><span class="p">%</span><span class="n">filename</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">file_varname</span><span class="o">=</span><span class="n">restore_inv_tau_input</span><span class="p">%</span><span class="n">file_varname</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">unit_conv_factor</span><span class="o">=</span><span class="n">restore_inv_tau_input</span><span class="p">%</span><span class="n">scale_factor</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">rank</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">dim3_len</span><span class="o">=</span><span class="n">km</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">case </span><span class="n">DEFAULT</span>
<span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="n">err_msg</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(A,1X,A)&quot;</span><span class="p">)</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">restore_inv_tau_opt</span><span class="p">),</span><span class="w">             </span><span class="p">&amp;</span>
<span class="w">             </span><span class="s1">&#39;is not a valid option for restore_inv_tau_opt&#39;</span>
<span class="w">        </span><span class="k">call </span><span class="n">document</span><span class="p">(</span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="n">err_msg</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">exit_POP</span><span class="p">(</span><span class="n">sigAbort</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Stopping in &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">subname</span><span class="p">)</span>
<span class="w">    </span><span class="k">end select</span>
<span class="k">    </span><span class="n">var_processed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">  </span><span class="k">end if</span>

<span class="k">  if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">var_processed</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">    select case</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">marbl_req_interior_tendency_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">metadata</span><span class="p">%</span><span class="n">varname</span><span class="p">))</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Dust Flux&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="n">dustflux_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="k">call </span><span class="n">interior_tendency_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;internal&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="n">driver_varname</span><span class="o">=</span><span class="s1">&#39;dust_flux&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;PAR Column Fraction&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="n">PAR_col_frac_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="k">call </span><span class="n">interior_tendency_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;internal&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="n">driver_varname</span><span class="o">=</span><span class="s1">&#39;PAR_col_frac&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">dim3_len</span><span class="o">=</span><span class="n">mcog_nbins</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="n">ldim3_is_depth</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Surface Shortwave&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="n">surf_shortwave_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="k">call </span><span class="n">interior_tendency_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;internal&#39;</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="n">driver_varname</span><span class="o">=</span><span class="s1">&#39;surf_shortwave&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">dim3_len</span><span class="o">=</span><span class="n">mcog_nbins</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="n">ldim3_is_depth</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Potential Temperature&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="n">potemp_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="k">call </span><span class="n">interior_tendency_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;internal&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="n">driver_varname</span><span class="o">=</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">dim3_len</span><span class="o">=</span><span class="n">km</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Salinity&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="n">salinity_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="k">call </span><span class="n">interior_tendency_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;internal&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="n">driver_varname</span><span class="o">=</span><span class="s1">&#39;salinity&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">dim3_len</span><span class="o">=</span><span class="n">km</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Pressure&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="n">pressure_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="k">call </span><span class="n">interior_tendency_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;internal&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="n">driver_varname</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">dim3_len</span><span class="o">=</span><span class="n">km</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Iron Sediment Flux&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="n">fesedflux_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="k">call </span><span class="n">interior_tendency_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="w">                </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;file_time_invariant&#39;</span><span class="p">,</span><span class="w">                 </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="n">filename</span><span class="o">=</span><span class="n">fesedflux_input</span><span class="p">%</span><span class="n">filename</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="n">file_varname</span><span class="o">=</span><span class="n">fesedflux_input</span><span class="p">%</span><span class="n">file_varname</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="n">unit_conv_factor</span><span class="o">=</span><span class="n">fesedflux_input</span><span class="p">%</span><span class="n">scale_factor</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="n">rank</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">dim3_len</span><span class="o">=</span><span class="n">km</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;O2 Consumption Scale Factor&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">select case</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">o2_consumption_scalef_opt</span><span class="p">))</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;const&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">interior_tendency_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;const&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">               </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">               </span><span class="n">field_constant</span><span class="o">=</span><span class="n">o2_consumption_scalef_const</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">dim3_len</span><span class="o">=</span><span class="n">km</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;file_time_invariant&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">interior_tendency_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">               </span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;file_time_invariant&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">               </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">               </span><span class="n">filename</span><span class="o">=</span><span class="n">o2_consumption_scalef_input</span><span class="p">%</span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">               </span><span class="n">file_varname</span><span class="o">=</span><span class="n">o2_consumption_scalef_input</span><span class="p">%</span><span class="n">file_varname</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">               </span><span class="n">unit_conv_factor</span><span class="o">=</span><span class="n">o2_consumption_scalef_input</span><span class="p">%</span><span class="n">scale_factor</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">               </span><span class="n">rank</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">dim3_len</span><span class="o">=</span><span class="n">km</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">        </span><span class="k">case </span><span class="n">default</span>
<span class="w">          </span><span class="k">call </span><span class="n">document</span><span class="p">(</span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;unknown o2_consumption_scalef_opt&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">o2_consumption_scalef_opt</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">exit_POP</span><span class="p">(</span><span class="n">sigAbort</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Stopping in &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">subname</span><span class="p">)</span>
<span class="w">        </span><span class="k">end select</span>
<span class="k">      case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Particulate Remin Scale Factor&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">select case</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">p_remin_scalef_opt</span><span class="p">))</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;const&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">interior_tendency_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;const&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">               </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">               </span><span class="n">field_constant</span><span class="o">=</span><span class="n">p_remin_scalef_const</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">dim3_len</span><span class="o">=</span><span class="n">km</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;file_time_invariant&#39;</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">interior_tendency_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">add_forcing_field</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">               </span><span class="n">field_source</span><span class="o">=</span><span class="s1">&#39;file_time_invariant&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">               </span><span class="n">marbl_varname</span><span class="o">=</span><span class="n">marbl_varname</span><span class="p">,</span><span class="w"> </span><span class="n">field_units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">               </span><span class="n">filename</span><span class="o">=</span><span class="n">p_remin_scalef_input</span><span class="p">%</span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">               </span><span class="n">file_varname</span><span class="o">=</span><span class="n">p_remin_scalef_input</span><span class="p">%</span><span class="n">file_varname</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">               </span><span class="n">unit_conv_factor</span><span class="o">=</span><span class="n">p_remin_scalef_input</span><span class="p">%</span><span class="n">scale_factor</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">               </span><span class="n">rank</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">dim3_len</span><span class="o">=</span><span class="n">km</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="w">        </span><span class="k">case </span><span class="n">default</span>
<span class="w">          </span><span class="k">call </span><span class="n">document</span><span class="p">(</span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;unknown p_remin_scalef_opt&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">p_remin_scalef_opt</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">exit_POP</span><span class="p">(</span><span class="n">sigAbort</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Stopping in &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">subname</span><span class="p">)</span>
<span class="w">        </span><span class="k">end select</span>
<span class="k">      case </span><span class="n">DEFAULT</span>
<span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="n">err_msg</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(A,1X,A)&quot;</span><span class="p">)</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">marbl_req_interior_tendency_forcings</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">metadata</span><span class="p">%</span><span class="n">varname</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                       </span><span class="s1">&#39;is not a valid interior tendency forcing field name.&#39;</span>
<span class="w">        </span><span class="k">call </span><span class="n">document</span><span class="p">(</span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="n">err_msg</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">exit_POP</span><span class="p">(</span><span class="n">sigAbort</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Stopping in &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">subname</span><span class="p">)</span>
<span class="w">    </span><span class="k">end select</span>
<span class="k">  end if</span>

<span class="k">end do</span><span class="w"> </span><span class="c">! do n=1,size(interior_tendency_forcings)</span>
</pre></div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="processing_MARBL_output.html" class="btn btn-neutral float-right" title="Processing MARBL Output" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tracers.html" class="btn btn-neutral" title="POP Interacting with MARBL Tracers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, National Science Foundation and U.S. Department of Energy.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
     
<script>var version_json_loc = "../../../versions.json";</script>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'cesm2.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="../../_static/pop_ver.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>